---
title: "New_Environmental"
output: html_document
date: "2025-08-01"
---

```{r}
library(tidyverse)
```
load data
```{r}
Meteorological_data <- read.csv("../Data/Meteorological data from the konza prairie/AWE012.csv")
watersheds<- read.csv("../Data/Watersheds.csv")
```
Rename columns to match with Meteorological data
```{r}
# Rename columns to match
colnames(Meteorological_data)[colnames(Meteorological_data) == "RECYEAR"] <- "RecYear"
colnames(Meteorological_data)[colnames(Meteorological_data) == "RECMONTH"] <- "RecMonth"  
colnames(Meteorological_data)[colnames(Meteorological_data) == "RECDAY"] <- "RecDay"
```
Convert meteorological variables to numeric
```{r}
Meteorological_data[c("TAVE", "DHUMID", "DSRAD", "DPPT")] <- lapply(Meteorological_data[c("TAVE", "DHUMID", "DSRAD", "DPPT")], as.numeric)
```
Calculate yearly averages directly from meteorological data (months 4-10). create a yearly_temp dataframe with two colums; RecYear and Average of Meteorological data
```{r}
yearly_temp <- Meteorological_data%>% 
  group_by(RecYear)%>%
  filter(RecMonth %in% seq(4,10,1)) %>% 
  summarise(mean_temp = mean(TAVE, na.rm= TRUE),
            mean_DHUMID = mean (DHUMID, na.rm = TRUE),
            mean_DSRAD = mean (DSRAD, na.rm = TRUE),
            mean_DPPT = mean (DPPT, na.rm = TRUE))
```

Join diversity_index + yearly meteorology (by RecYear using leftjoin)
```{r}
diversity_env <- diversityIndex %>%
  left_join(yearly_temp, by = "RecYear")
```
Join with watershed data (by WaterShed using leftjoin)
```{r}
final_data <- diversity_env %>%
  left_join(watersheds, by = "WaterShed")
final_data$AltName <- NULL
#sum how many rows of final_data for richness, simpson and shannon are NA
sum((is.na(final_data$richness) | final_data$richness == 0) & 
    (is.na(final_data$shannon)  | final_data$shannon == 0) & 
    (is.na(final_data$simpson)  | final_data$simpson == 0))

```











